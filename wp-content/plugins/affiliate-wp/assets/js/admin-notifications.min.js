"use strict";var affwp_notifications_vars;document.addEventListener("alpine:init",function(){Alpine.store("affwpNotifications",{isPanelOpen:!1,notificationsLoaded:!1,numberActiveNotifications:0,activeNotifications:[],inactiveNotifications:[],init:function(){var affwpNotifications=this,notificationCountBubble=document.querySelector("#affwp-notification-button .affwp-number");notificationCountBubble&&notificationCountBubble.classList.remove("affwp-hidden"),document.addEventListener("keydown",function(e){"Escape"===e.key&&affwpNotifications.closePanel()})},openPanel:function(){var affwpNotifications=this,panelHeader=document.getElementById("affwp-notifications-header");return affwpNotifications.isPanelOpen=!0,affwpNotifications.notificationsLoaded&&panelHeader?void panelHeader.focus():void affwpNotifications.apiRequest("/notifications","GET").then(function(data){affwpNotifications.activeNotifications=data.active,affwpNotifications.inactiveNotifications=data.dismissed,affwpNotifications.notificationsLoaded=!0,panelHeader&&panelHeader.focus()}).catch(function(error){})},closePanel:function(){var affwpNotifications=this;if(affwpNotifications.isPanelOpen){affwpNotifications.isPanelOpen=!1;var notificationButton=document.getElementById("affwp-notification-button");notificationButton&&notificationButton.focus()}},apiRequest:function(endpoint,method){return fetch(affwp_notifications_vars.restBase+endpoint,{method:method,credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":affwp_notifications_vars.restNonce}}).then(function(response){return response.ok?response.text():Promise.reject(response)}).then(function(data){return data?JSON.parse(data):null})},dismiss:function(event,index){var affwpNotifications=this;if("undefined"!=typeof affwpNotifications.activeNotifications[index]){event.target.disabled=!0;var notification=affwpNotifications.activeNotifications[index];affwpNotifications.apiRequest("/notifications/"+notification.id,"DELETE").then(function(response){affwpNotifications.activeNotifications.splice(index,1),affwpNotifications.numberActiveNotifications=affwpNotifications.activeNotifications.length}).catch(function(error){})}}})});